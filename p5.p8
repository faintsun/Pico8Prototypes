pico-8 cartridge // http://www.pico-8.com
version 16
__lua__
player = {}
player.x = 56
player.y = 56
player.dx = 1
player.dy = 1
player.yacc = 6
player.jumping = false
player.build = 0
player.size = 16
player.sprite = 1
player.frame = 0
player.sprite_timer = 0
player.crouch_timer = 0

-----------------------
--  update functions --
-----------------------

function _update()
	update_player()
	
	if player.sprite < 3 then
			update_player2()
	end

end

function update_player()

	-- if not crouching anymore
	if not btn(3) then
 	if player.sprite == 3 then
 		player.sprite = 1
 		sfx(4)
 	end
 	if player.sprite == 4 then
 		player.sprite = 2
 		sfx(4)
 	end
	end

	-- check if crouching
	if btn(3) then
		if player.sprite == 1 then
			player.sprite = 3
			sfx(3)
		end
		if player.sprite == 2 then
			player.sprite = 4
			sfx(3)
		end
	end
	
	-- move right
	if btn(1) then
	
		-- standing
		if player.sprite < 3 then
			player.sprite_timer += 1
 		player.x += 1
 		player.sprite = 1
 		
		-- crouching
		else
			player.crouch_timer += 1
			if player.crouch_timer > 10 then
				player.x += 3
				player.crouch_timer = 0
				player.sprite_timer += 10
			end	
		end
	end
	
	-- move left
	if btn(0) then
	
		-- standing
		if player.sprite < 3 then
			player.sprite_timer += 1
 		player.x -= 1
 		player.sprite = 2
 		
		-- crouching
		else
			player.crouch_timer += 1
			if player.crouch_timer > 10 then
				player.x -= 3
				player.crouch_timer = 0
				player.sprite_timer += 10
			end	
		end
	end
	
	
	
	if player.sprite_timer > 5 then
		player.sprite_timer = 0
		
		if player.sprite == 1 or player.sprite == 2 then
			sfx(0)
		end
		
		if player.sprite == 3 or player.sprite == 4 then
			sfx(1)
		end
		
		if player.frame == 0 then
			player.frame = 1
		else
			player.frame = 0
		end
	end

end

function update_player2()
	if btn(2) or btn(4) then
		player.build += 1
	elseif player.build > 0 and player.jumping == false then
			sfx(2)
			player.yacc = -(player.build*1.5)
			if player.yacc < -5 then
				player.yacc = -5
			end
			player.jumping = true
			player.build = 0
	end
	
	if player.jumping == true then
		player.y += player.yacc
		player.yacc += 1
		
		if player.y >= 56  then
 		player.yacc = 0
 		player.y = 56
 		player.jumping = false
	end

	end
end

function player_jump()
	player.jumping = true
	
	-- check to see if on ground
	if player.y >= 128 - player.size then
		player.yacc = 0
		player.y = 128 - player.size
		player.jumping = false
	end

	player.y += player.yacc
	player.yacc += 0.5
end

-----------------------
-- drawing functions --
-----------------------

function _draw()
	cls()
	mapdraw(0, 0, 0, 0, 16, 16)
	
	draw_player()
end

function draw_player()

	-- walking/facing right
	if player.sprite == 1 then
 	if player.frame == 0 then
 		spr(1, player.x, player.y, 2, 2)
 	else
 		spr(33, player.x, player.y, 2, 2)
 	end
	end
	
		-- walking/facing left
	if player.sprite == 2 then
 	if player.frame == 0 then
 		spr(3, player.x, player.y, 2, 2)
 	else
 		spr(35, player.x, player.y, 2, 2)
 	end
	end
	
	-- crouched - facing right
	if player.sprite == 3 then
 	if player.frame == 0 then
 		spr(5, player.x, player.y, 2, 2)
 	else
 		spr(37, player.x, player.y, 2, 2)
 	end
	end
	
		-- crouched - facing left
	if player.sprite == 4 then
 	if player.frame == 0 then
 		spr(7, player.x, player.y, 2, 2)
 	else
 		spr(39, player.x, player.y, 2, 2)
 	end
	end
	
end
__gfx__
00000000090000000a000a0000a000a0000000900000000000000000000000000000000000000000000000003333333333333333000000000000000000000000
00000000990000009a000a9009a000a9000000990000000000000000000000000000000000000000000000003333333333333333000000000000000000000000
00700700a90000009a9a9a9009a9a9a90000009a0000000000000000000000000000000000000000000000003333333333333333000000000000000000000000
00077000a9000000aaaaaaaaaaaaaaaa0000009a0000000000000000000000000000000000000000000000003333333333333333000000000000000000000000
00077000a9000000aacaacaaaacaacaa0000009a0000000000000000000000000000000000000000000000003333333333333333000000000000000000000000
00700700a9a9a9a9aaaaeaaaaaaeaaaa9a9a9a9a000000aaaa9a9a9009a9a9aaaa00000000000030000000003333333333333333000000000000000000000000
00000000a9a9a9a9aaaa4aaaaaa4aaaa9a9a9a9a00000009aaaaaaaaaaaaaaaa9000000003000330000030003333333333333333000000000000000000000000
00000000aaa9a9a9aaa444aaaa444aaa9a9a9aaa00000000aaaaaaaaaaaaaaaa0000000033003333030333003333333333333333000000000000000000000000
00000000aaaaaaaaaaaaaaa00aaaaaaaaaaaaaaa09a9a9a9aaacaacaaacaacaa9a9a9a9033333333333333333333333333333333000000000000000000000000
00000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa9a9a9a9aaaaaeaaaaaeaaaa9a9a9a9a33333333333333333333333333333333000000000000000000000000
00000000aaaaaaaaaaaaa9aaaa9aaaaaaaaaaaaaaa9999a9aaaa444aaa444aaa9a9999aa33333333333333333333333333333333000000000000000000000000
00000000aaaaaaaaaaaa9aaaaaa9aaaaaaaaaaaa9aaaa9aaaaaaaaa00aaaaaaaaa9aaaa933333333333333333333333333333333000000000000000000000000
00000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa99999aaaaaaaaa00aaaaaaaaa99999a33333333333333333333333333333333000000000000000000000000
000000000aaaaaaaaaaaaaa00aaaaaaaaaaaaaa0aaaaaaaaaaaaaaa00aaaaaaaaaaaaaaa33333333333333333333333333333333000000000000000000000000
000000000a0900000000a090090a0000000090a0a99aaaaaaa9aa990099aa9aaaaaaa99a33333333333333333333333333333333000000000000000000000000
000000000a0900000000a090090a0000000090a0aaa999009999aaa99aaa999900999aaa33333333333333333333333333333333000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000090000000a000a0000a000a0000000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000990000009a000a9009a000a9000000990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000a90000009a9a9a9009a9a9a90000009a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000a9000000aaaaaaaaaaaaaaaa0000009a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000a9000000aacaacaaaacaacaa0000009a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000a9a9a9a9aaaaeaaaaaaeaaaa9a9a9a9a000000aaaa9a9a9009a9a9aaaa00000000000000000000000000000000000000000000000000000000000000
00000000a9a9a9a9aaaa4aaaaaa4aaaa9a9a9a9a00000009aaaaaaaaaaaaaaaa9000000000000000000000000000000000000000000000000000000000000000
00000000aaa9a9a9aaa444aaaa444aaa9a9a9aaa00000000aaaaaaaaaaaaaaaa0000000000000000000000000000000000000000000000000000000000000000
00000000aaaaaaaaaaaaaaa00aaaaaaaaaaaaaaa09a9a9a9aaacaacaaacaacaa9a9a9a9000000000000000000000000000000000000000000000000000000000
00000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa9a9a9a9aaaaaeaaaaaeaaaa9a9a9a9a00000000000000000000000000000000000000000000000000000000
00000000aaaaaaaaaaaaa9aaaa9aaaaaaaaaaaaaaa9999a9aaaa444aaa444aaa9a9999aa00000000000000000000000000000000000000000000000000000000
00000000aaaaaaaaaaaa9aaaaaa9aaaaaaaaaaaa9aaaa9aaaaaaaaa00aaaaaaaaa9aaaa900000000000000000000000000000000000000000000000000000000
00000000aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa99999aaaaaaaaa00aaaaaaaaa99999a00000000000000000000000000000000000000000000000000000000
000000000aaaaaaaaaaaaaa00aaaaaaaaaaaaaa0aa999aaaa9a9a990099a9a9aaaa999aa00000000000000000000000000000000000000000000000000000000
000000000a0900000000a090090a0000000090a0aaaaa9009aaa99990999aaa9009aaaaa00000000000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000009aaa999900999aaa00000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2929292929292929292929292929292900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000292929292929290000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000009000a000a00000009000a00000900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
19191919191919191919190b1919191919191900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1919191919191919191919191919191919191900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1919191919191919191919191919191919191900190000191900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1919191919191919191919191919191919191900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1919191919191919191919191919191919191900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100002405000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000001e05000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000500001e05020050220500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000100000000025050220501e0501d0501c0501b0501a050190501605013050110500d05000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000100000000011050130501505017050190501b0501d0502005022050270502a0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
